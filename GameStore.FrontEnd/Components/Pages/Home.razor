@page "/"
@inject GameClient Client

<PageTitle>Game Store</PageTitle>

<div class="mt-2">
    <a class="btn btn-primary" role="button" href="/editgame">New Game</a>
</div>
<table class="table table-striped table-bordered table-hover mt-2">
    <thead class="table-dark">
        <tr>
            
            <th>Id</th>
            <th>Name</th>
            <th>Genre</th>       
            <th class="text-end">Price</th>
            <th>Release Date</th>
            <th>Actions</th>
            

        </tr>

    </thead>
    <tbody>
      
        
        <tr>
        @if(games is null){
            <td colspan="6">Loading...</td>
        }
        else{
          
          @foreach (var game in games)
          {
            <tr>
                <td>@game.Id</td>
                <td>@game.Name</td>
                <td>@game.Genre</td>
                <td class="text-end">@game.Price.ToString("C2")</td>
                <td>@game.ReleaseDate.ToString("d")</td>
                <td>
                    <div>
                        <a href="@GameUrl(game.Id)" class="btn btn-primary"><i class="bi bi-pencil-square"></i></a>
                        <!-- Button trigger modal -->
                        <button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="@GetDeleteModalId(game)">
                            <i class="bi bi-trash"></i>
                        </button>

                        
                    </div>
                    <DeleteGame Game="@game" />
                </td>
            </tr>
          } 
          }
        </tr>
    </tbody> 
        
</table>

@code {
    
    private Games[]? games;

    override protected void OnInitialized()
    {
        
        games = Client.GetAllGames();
    }

    private static string GameUrl(int id) => $"/editgame/{id}";

    private string GetDeleteModalId(Games game) => $"#{DeleteGame.GetModalId(game)}";
}